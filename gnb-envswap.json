{
    "_comment": "This is a template for the Scoop manifest. The version and hash are updated automatically by the release workflow.",
    "version": "0.1.0",
    "description": "A CLI tool with a TUI to quickly and safely switch environment variables in a PowerShell session.",
    "homepage": "https://github.com/gennobou/gnb-envswap",
    "license": "MIT",
    "url": "https://github.com/gennobou/gnb-envswap/releases/download/v${version}/gnb-envswap-v${version}.zip",
    "hash": "",
    "bin": "gnb-envswap.exe",
    "checkver": "github",
    "autoupdate": {
        "url": "https://github.com/gennobou/gnb-envswap/releases/download/v${version}/gnb-envswap-v${version}.zip"
    },
    "post_install": [
        "$profile = $PROFILE",
        "if (!(Test-Path $profile)) {",
        "    Write-Host \"Creating PowerShell profile: $profile\"",
        "    New-Item -Path $profile -ItemType File -Force | Out-Null",
        "}",
        "$funcDef = \"function envswap { gnb-envswap | Invoke-Expression }\"",
        "$content = Get-Content $profile -Raw",
        "if ($content -notmatch 'function\\s+envswap\\s*\\{') {",
        "    $block = \"`n# Added by gnb-envswap installer`n$funcDef`n\"",
        "    Add-Content -Path $profile -Value $block",
        "    Write-Host \"'envswap' function added to your PowerShell profile. Please restart your shell or run '. $profile' to use it.\"",
        "} else {",
        "    Write-Host \"'envswap' function already exists in your PowerShell profile. No changes were made.\"",
        "}"
    ],
    "post_uninstall": [
        "$profile = $PROFILE",
        "if (Test-Path $profile) {",
        "    $content = Get-Content $profile -Raw",
        "    $pattern = '(?sm)^\\s*# Added by gnb-envswap installer\\s*?.*?function envswap\\s*\\{.*?\\}\\s*?`n?'",
        "    if ($content -match $pattern) {",
        "        $newContent = $content -replace $pattern, ''",
        "        $newContent.Trim() | Set-Content -Path $profile -NoNewline",
        "        Write-Host \"'envswap' function removed from your PowerShell profile.\"",
        "    }",
        "}"
    ]
}
